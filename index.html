<!DOCTYPE html>
<html lang="en" ng-app="bikeApp">

<head>
    <meta charset="UTF-8">
    <title>Off Track</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link href='https://fonts.googleapis.com/css?family=Alegreya+Sans+SC|Open+Sans+Condensed:300,700|Yellowtail' rel="stylesheet" type="text/css">
    <link href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.1.1/normalize.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="http://maps.google.com/maps/api/js?key=AIzaSyD7buZcMEjcjwpMa8qztndpYmCxxP-Te2A"></script>

    <script>
        function writeAddressName(latLng) {
            var geocoder = new google.maps.Geocoder();
            geocoder.geocode({
                    "location": latLng
                },
                function (results, status) {
                    if (status == google.maps.GeocoderStatus.OK)
                        document.getElementById("address").innerHTML = results[0].formatted_address;
                    else
                        document.getElementById("error").innerHTML += "Unable to retrieve your address" + "<br />";
                });
            console.log(latLng);
        }

        function geolocationSuccess(position) {
            var userLatLng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
            // Write the formatted address
            writeAddressName(userLatLng);

            var myOptions = {
                zoom: 16,
                center: userLatLng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            console.log(myOptions.center);
            // Draw the map
            var mapObject = new google.maps.Map(document.getElementById("map"), myOptions);
            // Place the marker
            new google.maps.Marker({
                map: mapObject,
                position: userLatLng
            });
            // Draw a circle around the user position to have an idea of the current localization accuracy
            var circle = new google.maps.Circle({
                center: userLatLng,
                radius: position.coords.accuracy,
                map: mapObject,
                fillColor: '#0000FF',
                fillOpacity: 0.5,
                strokeColor: '#0000FF',
                strokeOpacity: 1.0
            });
            mapObject.fitBounds(circle.getBounds());
        }

        function geolocationError(positionError) {
            document.getElementById("error").innerHTML += "Error: " + positionError.message + "<br />";
        }

        function geolocateUser() {
            // If the browser supports the Geolocation API
            if (navigator.geolocation) {
                var positionOptions = {
                    enableHighAccuracy: true,
                    timeout: 10 * 1000 // 10 seconds
                };
                navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError, positionOptions);
            } else
                document.getElementById("error").innerHTML += "Your browser doesn't support the Geolocation API";
        }

        window.onload = geolocateUser;
    </script>
</head>

<body ng-controller="getTrailController">
    <header>
    <div class="header-text">   
    <h1>Off Track</h1>
       <div class="instruction-container">
        <p>Do you love the outdoors? Would your rather be biking deep in the mountains than sitting at home in front of a screen? Off Track is an application to help you find your next outdoor adventure. Click the button below to search for hiking, camping and biking trails closest to your geographical location. Your next experience is just a click away!</p>
        </div>
        <button class="callToActionButton">Discover</button>
        </div>
    </header>
    <section>
       <div class="search-container">
        <input class="search" type="text" name="search" placeholder="search">
        <button class="search"><i class="icon ion-search"></i></button>
        </div>
    </section>
    <section class="trail-results">
        <div>
            <ul><li></li></ul>
        </div>
        <div></div>
        <button>Reset</button>
    </section>
    <section class="trail-details">
        <div>
            <div></div>
            <div id="map"></div>
            <div id="weather"></div>
        </div>
        <button class="details-button">Back</button>
        <button class="details-button">Get Directions</button>
        <button class="details-button">My Favorites</button>
    </section>
    <!--ng-view or ng-hide/show for section to display results of search-->
    <section>
        <p><b>Address</b>: <span id="address"></span></p>
        <p id="error"></p>
    </section>
    <footer></footer>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.min.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular-animate.js" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular-route.js" type="text/javascript"></script>
    <script src="js/app.js" type="text/javascript"></script>
</body>

</html>
